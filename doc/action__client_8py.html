<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ass1_RT2: scripts/action_client.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ass1_RT2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_53e6fa9553ac22a5646d2a2b2d7b97a1.html">scripts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">action_client.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Sends a goal to the action server, consisting of the x and y coordinates, which are read from the launch file, that the mobile robot must reach.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a26de5b9075ea5cb19268eae5f9bb491a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="action__client_8py.html#a26de5b9075ea5cb19268eae5f9bb491a">action_client.goal_planning_client</a> (t_pose)</td></tr>
<tr class="memdesc:a26de5b9075ea5cb19268eae5f9bb491a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a planning goal to an action server and allows monitoring the progress towards the goal.  <a href="action__client_8py.html#a26de5b9075ea5cb19268eae5f9bb491a">More...</a><br /></td></tr>
<tr class="separator:a26de5b9075ea5cb19268eae5f9bb491a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f082c3b3b4b30b8d1f68af7f8970fa"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="action__client_8py.html#a26f082c3b3b4b30b8d1f68af7f8970fa">action_client.clbk_odom</a> (msg)</td></tr>
<tr class="memdesc:a26f082c3b3b4b30b8d1f68af7f8970fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The clbk_odom function is a callback that updates the global pose and twist based on incoming odometry data from the robot.  <a href="action__client_8py.html#a26f082c3b3b4b30b8d1f68af7f8970fa">More...</a><br /></td></tr>
<tr class="separator:a26f082c3b3b4b30b8d1f68af7f8970fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d661b687a2ef1a2850045bbe55bf2a8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="action__client_8py.html#a4d661b687a2ef1a2850045bbe55bf2a8">action_client.feedback_callback</a> (feedback)</td></tr>
<tr class="memdesc:a4d661b687a2ef1a2850045bbe55bf2a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes feedback from the action server and computes the remaining distance.  <a href="action__client_8py.html#a4d661b687a2ef1a2850045bbe55bf2a8">More...</a><br /></td></tr>
<tr class="separator:a4d661b687a2ef1a2850045bbe55bf2a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba1e5da098ec4cd42e112ccbd9ee321"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="action__client_8py.html#afba1e5da098ec4cd42e112ccbd9ee321">action_client.done_callback</a> (state, result)</td></tr>
<tr class="memdesc:afba1e5da098ec4cd42e112ccbd9ee321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logs when the goal has been reached.  <a href="action__client_8py.html#afba1e5da098ec4cd42e112ccbd9ee321">More...</a><br /></td></tr>
<tr class="separator:afba1e5da098ec4cd42e112ccbd9ee321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece5b3dc7f370ff7ab45e105b5e6bbaa"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="action__client_8py.html#aece5b3dc7f370ff7ab45e105b5e6bbaa">action_client.main</a> ()</td></tr>
<tr class="memdesc:aece5b3dc7f370ff7ab45e105b5e6bbaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the ROS node and continuously updates the target position.  <a href="action__client_8py.html#aece5b3dc7f370ff7ab45e105b5e6bbaa">More...</a><br /></td></tr>
<tr class="separator:aece5b3dc7f370ff7ab45e105b5e6bbaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44ecdd25f82d6866f8b56edbd705e6d2"><td class="memItemLeft" align="right" valign="top"><a id="a44ecdd25f82d6866f8b56edbd705e6d2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.pose</b> = PoseStamped()</td></tr>
<tr class="separator:a44ecdd25f82d6866f8b56edbd705e6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4e2d905d31882001382920c07f4fd6"><td class="memItemLeft" align="right" valign="top"><a id="aef4e2d905d31882001382920c07f4fd6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.pose_</b> = Pose()</td></tr>
<tr class="separator:aef4e2d905d31882001382920c07f4fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97165e1ee4f1fd4df50e54af339a8ba"><td class="memItemLeft" align="right" valign="top"><a id="af97165e1ee4f1fd4df50e54af339a8ba"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.twist_</b> = Twist()</td></tr>
<tr class="separator:af97165e1ee4f1fd4df50e54af339a8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf7cd9c8abb8888bac528688269b9c5"><td class="memItemLeft" align="right" valign="top"><a id="aedf7cd9c8abb8888bac528688269b9c5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.msg</b> = pos_vel()</td></tr>
<tr class="separator:aedf7cd9c8abb8888bac528688269b9c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92c93b3d3d7f8edde1ea469d5717841"><td class="memItemLeft" align="right" valign="top"><a id="ab92c93b3d3d7f8edde1ea469d5717841"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.pub</b> = rospy.Publisher('/pos_vel', pos_vel, queue_size=10)</td></tr>
<tr class="separator:ab92c93b3d3d7f8edde1ea469d5717841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada492458805b0a39b0b26ff99281f3fb"><td class="memItemLeft" align="right" valign="top"><a id="ada492458805b0a39b0b26ff99281f3fb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_client.targ_pub</b> = rospy.Publisher('/last_target', PoseStamped, queue_size=10)</td></tr>
<tr class="separator:ada492458805b0a39b0b26ff99281f3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sends a goal to the action server, consisting of the x and y coordinates, which are read from the launch file, that the mobile robot must reach. </p>
<dl class="section author"><dt>Author</dt><dd>Marco Petrosilli </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15/03/2025</dd></dl>
<p>Subscribes to: <br  />
 /odom</p>
<p>Publishes to: <br  />
 /pos_target /vel_last</p>
<p>Description: <br  />
 This node implements an action client that sends position goals to the mobile robot. It reads initial target coordinates (x,y) from the launch file parameters and sends them to the action server. The node allows users to input new target coordinates during execution, monitors the robot's progress toward the goal, and provides the option to cancel the goal by typing 'c' in the terminal. It continuously publishes the robot's current position and velocity while tracking the goal. The node also handles goal completion callbacks and feedback processing to provide status updates during execution. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a26f082c3b3b4b30b8d1f68af7f8970fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f082c3b3b4b30b8d1f68af7f8970fa">&#9670;&nbsp;</a></span>clbk_odom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def action_client.clbk_odom </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The clbk_odom function is a callback that updates the global pose and twist based on incoming odometry data from the robot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The odometry message containing the robot's current pose and twist (linear and angular velocity). It is of type nav_msgs/Odometry. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function does not return any value. It updates the global variables pose_ and twist_ with the current robot pose and twist data.</dd></dl>
<p>This function acts as a callback for the /odom topic, updating global variables pose_ and twist_ with the current position and velocity of the robot. These values are essential for monitoring the robot's movement and ensuring it follows the planned trajectory. </p>

</div>
</div>
<a id="afba1e5da098ec4cd42e112ccbd9ee321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba1e5da098ec4cd42e112ccbd9ee321">&#9670;&nbsp;</a></span>done_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def action_client.done_callback </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logs when the goal has been reached. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result</td><td>The result of the goal execution, which contains the outcome of the action. This parameter can hold any relevant data returned by the action server (not used in this function). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function does not return any value.</dd></dl>
<p>This function is called when the goal execution is completed. It verifies whether the goal was successfully reached and logs the outcome accordingly. </p>

</div>
</div>
<a id="a4d661b687a2ef1a2850045bbe55bf2a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d661b687a2ef1a2850045bbe55bf2a8">&#9670;&nbsp;</a></span>feedback_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def action_client.feedback_callback </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>feedback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes feedback from the action server and computes the remaining distance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">feedback</td><td>The feedback message from the action server. It contains the current pose of the robot, specifically the actual position (feedback.actual_pose.position), which is used to compute the distance to the target position. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function does not return any value.</dd></dl>
<p>This function calculates the Euclidean distance between the robot's current position and the target. It logs the robot's position and the remaining distance to help monitor progress. </p>

</div>
</div>
<a id="a26de5b9075ea5cb19268eae5f9bb491a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26de5b9075ea5cb19268eae5f9bb491a">&#9670;&nbsp;</a></span>goal_planning_client()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def action_client.goal_planning_client </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t_pose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a planning goal to an action server and allows monitoring the progress towards the goal. </p>
<p>It also provides the ability to cancel the goal during execution. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_pose</td><td>The target position (pose) that the robot should reach. It is a geometry_msgs/Pose object containing the desired position and orientation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The result of the action after it completes, which can be obtained via the client.get_result() method. The result depends on the behavior of the action as defined in the action server.</dd></dl>
<p>This function communicates with an action server to send a goal specifying the robot's target position. It waits for the server to be available, sends the goal, and allows real-time monitoring of its progress. Users can cancel the goal by typing 'c' in the terminal. The function continuously publishes the robot?s current position and velocity until the goal is reached or canceled. </p>

</div>
</div>
<a id="aece5b3dc7f370ff7ab45e105b5e6bbaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece5b3dc7f370ff7ab45e105b5e6bbaa">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def action_client.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the ROS node and continuously updates the target position. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function does not return any value.</dd></dl>
<p>The main function initializes the ROS node, subscribes to the /odom topic, and sets the robot's target position using parameters retrieved from the launch file. It allows users to input new target coordinates dynamically and sends them to the goal planning function for execution. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
